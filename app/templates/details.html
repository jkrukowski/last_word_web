{% extends "layout.html" %}
{% block body %}
<script>

</script>
<div id="filterModal" class="modal fade">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title">Score Filter</h4>
      </div>
      <form action="{{ url_for('user_query') }}" method="get" role="form">
          <div class="modal-body">

                <div class="form-group">
                    <label for="currentQuery">Current query</label>
                    <input id="currentQuery" type="text" class="form-control" placeholder="{{ user_input }}" value="{{ user_input }}" name="q" readonly>
                </div>
                <div class="form-group">
                    <label for="scoreFilter">Minimal query score</label>
                    <input id="scoreFilter" type="text" class="form-control" placeholder="{{ score_threshold }}" name="min">
                </div>

          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            <button id="applyFilterButton" type="submit" class="btn btn-primary">Apply filter</button>
          </div>
      </form>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
<div class="page-header">
    <h1>Last Words <small>of every inmate executed in Texas since 1984</small></h1>
</div>
<div class="row">
    <div class="col-md-8">
        <p class="lead">Results for: <strong>{{ user_input }}</strong>, minimal score: <strong>{{ score_threshold }}</strong></p>
    </div>
    <div class="col-md-4 text-right">
        <a id="toogleGraphs" class="btn btn-primary" href="#" role="button">Show graphs</a>
        <a class="btn btn-default" data-toggle="modal" data-target="#filterModal">Enter score filter</a>
        <a class="btn btn-default" href="{{ url_for('main_page') }}" role="button">New query</a>
    </div>
</div>
<div id="graphArea1" class="row" style="display: none;">
    <div class="col-md-4">
        <h4>Race Distribution (%)</h4>
        <canvas id="firstChart" width="360" height="360"></canvas>
        <h6 id="plot1Legend"></h6>
    </div>
    <div class="col-md-4">
        <h4>Age Distribution (%)</h4>
        <canvas class="text-center" id="secondChart" width="360" height="360"></canvas>
        <h6 id="plot2Legend"></h6>
    </div>
    <div class="col-md-4">
        <h4>Executions By Year (%)</h4>
        <canvas class="text-right" id="thirdChart" width="360" height="360"></canvas>
        <h6 id="plot3Legend"></h6>
    </div>
    <div class="col-md-12">
        <h4>Score Distribution</h4>
        <canvas id="scoreChart" width="1140" height="360"></canvas>
        <h6 id="plot4Legend"></h6>
    </div>
</div>
<table class="table table-hover">
    <thead>
        <tr>
            <th>#</th>
            <th>Score</th>
            <th>Last Name</th>
            <th>First Name</th>
            <th>Statement</th>
            <th class="text-center">Full Statement</th>
            <th>Age</th>
            <th>Race</th>
            <th>Date</th>
            <th class="text-center">Inmate Details</th>
        </tr>
    </thead>
    <tbody>
        {% for item in result %}
        <tr>
            <td>{{ loop.index }}</td>
            <td>{{ '%0.3f'| format(item.sim|float) }}</td>
            <td>{{ item.surename }}</td>
            <td>{{ item.name }}</td>
            <td>{{ item.short_stm }}</td>
            <td class="text-center"><a href="{{ url_for('inmate_details', inmate_id=item.index) }}"><span class="glyphicon glyphicon-file"></span></a></td>
            <td>{{ item.age }}</td>
            <td>{{ item.race }}</td>
            <td>{{ item.date_str }}</td>
            <td class="text-center"><a href="{{ item.info_link }}" target="_blank"><span class="glyphicon glyphicon-list-alt"></span></a></td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}
